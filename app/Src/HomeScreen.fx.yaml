HomeScreen As screen:
    Fill: |
        =RGBA(255,255,255,1)
    Height: =Max(App.Height, App.DesignHeight)
    OnHidden: =Set(_showDetails, false)
    OnVisible: |-
        =Set(LeaveTempID,LookUp(LeaveApp_Request,ID = GalleryRequest.Selected.ID));
        Set(LeaveAnnualCarriedTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualCarriedForward);
        Set(LeaveAnnualTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualLeaveTaken);
        Set(LeaveMedicalTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MedicalLeaveTaken);
        Set(LeaveCasualImmediateTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualLeaveTaken);
        Set(LeaveCasualSecondTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).CasualSecondLeaveTaken);
        Set(LeaveMarriageTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MarriageLeaveTaken);
        Set(LeavePaternityTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).PaternityLeaveTaken);
        Set(LeaveMaternityTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MaternityLeaveTaken);
        Set(LeaveHospitalizationTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).HospitalizationLeaveTaken);
        Reset(RemarksTextBox);
        Refresh(LeaveApp_Request);
    Orientation: =If(HomeScreen.Width < HomeScreen.Height, Layout.Vertical, Layout.Horizontal)
    Size: =1 + CountRows(App.SizeBreakpoints) - CountIf(App.SizeBreakpoints, Value >= HomeScreen.Width)
    Width: =Max(App.Width, App.DesignWidth)

    "GalleryRequest As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver5.0'":
        BorderThickness: =
        DelayItemLoading: =true
        Fill: =RGBA(255, 255, 255, 1)
        Height: =610
        Items: |+
            =If(
                !_managerView,
                If(
                    ButtonFilter.Selected.Filter = "All",
                    Sort(
                        Filter(
                            LeaveApp_Request,
                            Year(Start_Date) = Year(Today()) && Created_By.Email = User().Email
                        ),
                        Start_Date,
                        SortOrder.Descending
                    ),
                    Sort(
                        Filter(
                            LeaveApp_Request,
                            Status.Value = ButtonFilter.Selected.Filter && Year(Start_Date) = Year(Today()) && Created_By.Email = User().Email
                        ),
                        Start_Date,
                        SortOrder.Descending
                    )
                ),
                If(
                    ButtonFilter.Selected.Filter = "All",
                    Sort(
                        Filter(
                            LeaveApp_Request,
                            Year(Start_Date) = Year(Today()) && Requested_to.Email = User().Email
                        ),
                        Start_Date,
                        SortOrder.Descending
                    ),
                    Sort(
                        Filter(
                            LeaveApp_Request,
                            Status.Value = ButtonFilter.Selected.Filter && Year(Start_Date) = Year(Today()) && Requested_to.Email = User().Email
                        ),
                        Start_Date,
                        SortOrder.Descending
                    )
                )
            )
            
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: |
            =Set(_selectedLeaveItem, ThisItem);
            Set(SelectedRecord,GalleryRequest.Selected);
            
            Set(LeaveTempID,LookUp(LeaveApp_Request,ID = GalleryRequest.Selected.ID));
            Set(LeaveAnnualCarriedTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualCarriedForward);
            Set(LeaveAnnualTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualLeaveTaken);
            Set(LeaveMedicalTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MedicalLeaveTaken);
            Set(LeaveCasualImmediateTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualLeaveTaken);
            Set(LeaveCasualSecondTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).CasualSecondLeaveTaken);
            Set(LeaveMarriageTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MarriageLeaveTaken);
            Set(LeavePaternityTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).PaternityLeaveTaken);
            Set(LeaveMaternityTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MaternityLeaveTaken);
            Set(LeaveHospitalizationTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).HospitalizationLeaveTaken);
            
            Reset(RemarksTextBox);
        TemplatePadding: =0
        TemplateSize: =171
        Width: =820
        X: =231
        Y: =158
        ZIndex: =1

        TitleStartDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =24
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =If(IsBlank(ThisItem.Days) , "-", ThisItem.Days& " day(s)")
            VerticalAlign: =VerticalAlign.Top
            Width: =353
            X: =136
            Y: =51
            ZIndex: =1

        SubtitleEndDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =27
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =Text(ThisItem.Start_Date, "[$-en-US]ddd, dd mmm yyyy") & "  -  " & Text(ThisItem.End_Date, "[$-en-US]ddd, dd mmm yyyy") 
            VerticalAlign: =VerticalAlign.Top
            Width: =465
            X: =136
            Y: =98
            ZIndex: =2

        Separator1 As rectangle:
            Fill: =RGBA(230, 230, 230, 1)
            Height: =3
            OnSelect: =
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =5

        Rectangle2 As rectangle:
            Height: =Parent.TemplateHeight - Separator1.Height
            OnSelect: =Select(Parent)
            Visible: =ThisItem.IsSelected
            Width: =4
            ZIndex: =6

        Label3 As label:
            Height: =121
            OnSelect: =
            Size: =14
            Text: |-
                ="Total days:
                
                Durations:"
            X: =20
            Y: =24
            ZIndex: =8

        ButtonStatus As button:
            BorderColor: |-
                =If((ThisItem.Status.Value)="Pending",RGBA(0,71,144,1),
                (ThisItem.Status.Value)="Rejected",RGBA(213,0,0,1),
                (ThisItem.Status.Value)="Approved",RGBA(0,128,0,1))
            Color: |-
                =If((ThisItem.Status.Value)="Pending",RGBA(0,71,144,1),
                (ThisItem.Status.Value)="Rejected",RGBA(213,0,0,1),
                (ThisItem.Status.Value)="Approved",RGBA(0,128,0,1))
            Fill: =RGBA(255, 255, 255, 1)
            OnSelect: =
            Text: =ThisItem.Status.Value
            X: =624
            Y: =85
            ZIndex: =9

        Label26 As label:
            Color: =RGBA(101, 128, 187, 1)
            FontWeight: =FontWeight.Bold
            Height: =51
            OnSelect: =Select(Parent)
            Size: =15.7
            Text: =ThisItem.Created_By.DisplayName
            Visible: =_managerView=true
            Width: =604
            X: =20
            ZIndex: =10

    "ButtonFilter As gallery.'BrowseLayout_Vertical_OneTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =104
        Items: |-
            =Table({Filter: "All"}, {Filter: "Pending"}, {Filter: "Approved"}, {Filter: "Rejected"})
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        ShowScrollbar: =false
        TemplatePadding: =1
        TemplateSize: =98
        Width: =624
        WrapCount: =4
        X: =349
        Y: =73
        ZIndex: =2

        ButtonCategories As button:
            BorderColor: =RGBA(62, 96, 170, 1)
            BorderThickness: =3
            Color: =If(ButtonFilter.Selected.Filter=ThisItem.Filter,RGBA(255, 255, 255, 1),RGBA(0,71,144,1))
            DisabledBorderColor: =ColorFade(ButtonFilter.BorderColor, 30%)
            Fill: =If(ButtonFilter.Selected.Filter=ThisItem.Filter,RGBA(0, 71, 144, 1),RGBA(255, 255, 255, 1))
            Font: =Font.'Lato Black'
            Height: =37
            OnSelect: =
            PressedBorderColor: =ButtonFilter.Fill
            PressedColor: =If(ButtonFilter.Selected.Filter=ThisItem.Filter,RGBA(255, 255, 255, 1),RGBA(0,71,144,1))
            RadiusBottomLeft: =35
            RadiusBottomRight: =35
            RadiusTopLeft: =35
            RadiusTopRight: =35
            Text: =ThisItem.Filter
            Width: =110
            Y: =27
            ZIndex: =6

    RectNavSep As rectangle:
        DisabledFill: =RectNavSep.Fill
        Fill: =RGBA(204, 204, 204, 1)
        FocusedBorderColor: =RectNavSep.BorderColor
        Height: =688
        HoverFill: =RectNavSep.Fill
        PressedFill: =RectNavSep.Fill
        Width: =1
        X: =231
        Y: =80
        ZIndex: =3

    Rectangle2_1 As rectangle:
        DisabledFill: =Rectangle2_1.Fill
        Fill: =RGBA(230, 230, 230, 1)
        FocusedBorderColor: =Rectangle2_1.BorderColor
        Height: =2
        HoverFill: =Rectangle2_1.Fill
        OnSelect: =
        PressedFill: =Rectangle2_1.Fill
        Width: =820
        X: =231
        Y: =154
        ZIndex: =4

    Navigation_5 As Navigation:
        CurrentScreen: ="My Leave Requests"
        NavItem: =If(_managerView,ManagerNavigation, EmployeeNavigation)
        Y: =80
        ZIndex: =12

    LblLeaveDetail As label:
        Height: =35
        Text: |-
            ="Leave Detail:"
        Width: =145
        X: =1071
        Y: =454
        ZIndex: =29

    LeaveDetail As label:
        FontWeight: =FontWeight.Semibold
        Height: =51
        Overflow: =Overflow.Scroll
        Text: =If(IsBlank(GalleryRequest.Selected.Comments) , "-", GalleryRequest.Selected.Comments)
        VerticalAlign: =VerticalAlign.Top
        Width: =294
        X: =1071
        Y: =489
        ZIndex: =30

    GroupRequestDetails As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =32

    Icon3_1 As icon.Reload:
        Height: =35
        Icon: =Icon.Reload
        OnSelect: =Refresh(LeaveApp_Request);
        Width: =35
        X: =987
        Y: =101
        ZIndex: =34

    LabelNoRecordMsg As label:
        FontWeight: =FontWeight.Semibold
        Height: =41
        Text: ="No Record Found"
        Visible: |-
            =If(
                GalleryRequest.AllItemsCount = 0,
                true,  // Show the label if the gallery is empty
                false  // Hide the label if there are records in the gallery
            )
        Width: =186
        X: =581
        Y: =161
        ZIndex: =35

    Header_11 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =51

        Rectangle1_11 As rectangle:
            DisabledFill: =Rectangle1_11.Fill
            Fill: =RGBA(0, 71, 144, 1)
            FocusedBorderColor: =Rectangle1_11.BorderColor
            Height: =80
            HoverFill: =Rectangle1_11.Fill
            PressedFill: =Rectangle1_11.Fill
            Width: =1366
            ZIndex: =5

        LblHeaderTItle1_11 As label:
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =LblHeaderTItle1_11.BorderColor
            Font: =Font.Lato
            Height: =80
            HoverBorderColor: =LblHeaderTItle1_11.BorderColor
            HoverColor: =LblHeaderTItle1_11.Color
            HoverFill: =LblHeaderTItle1_11.Fill
            PressedBorderColor: =LblHeaderTItle1_11.BorderColor
            PressedColor: =LblHeaderTItle1_11.Color
            PressedFill: =LblHeaderTItle1_11.Fill
            Size: =18
            Text: =Upper("Request")
            Width: =117
            X: =30
            ZIndex: =6

        LblHeaderTitle2_11 As label:
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =LblHeaderTitle2_11.BorderColor
            Height: =80
            HoverBorderColor: =LblHeaderTitle2_11.BorderColor
            HoverColor: =LblHeaderTitle2_11.Color
            HoverFill: =LblHeaderTitle2_11.Fill
            PressedBorderColor: =LblHeaderTitle2_11.BorderColor
            PressedColor: =LblHeaderTitle2_11.Color
            PressedFill: =LblHeaderTitle2_11.Fill
            Size: =18
            Text: =Upper("Leave")
            Width: =138
            X: =178
            ZIndex: =7

        icon2_11 As icon.ArrowRight:
            Color: =Color.White
            DisabledFill: =icon2_11.Fill
            FocusedBorderColor: =icon2_11.BorderColor
            HoverBorderColor: =ColorFade(icon2_11.BorderColor, 20%)
            HoverColor: =ColorFade(icon2_11.Color, 20%)
            HoverFill: =icon2_11.Fill
            Icon: =Icon.ArrowRight
            PressedBorderColor: =ColorFade(icon2_11.BorderColor, -20%)
            PressedColor: =ColorFade(icon2_11.Color, -20%)
            PressedFill: =icon2_11.Fill
            Width: =32
            X: =143
            Y: =9
            ZIndex: =8

        CircleHeaderCreateNew_9 As circle:
            DisabledFill: =CircleHeaderCreateNew_9.Fill
            Fill: =Color.White
            FocusedBorderColor: =CircleHeaderCreateNew_9.BorderColor
            Height: =46
            HoverFill: =CircleHeaderCreateNew_9.Fill
            PressedFill: =CircleHeaderCreateNew_9.Fill
            Visible: =If(_managerView,false,true)
            Width: =46
            X: =1155
            Y: =17
            ZIndex: =9

        IconHeaderCreateNew As icon.Add:
            AccessibleLabel: ="Create new leave request"
            Color: =Rectangle1_11.Fill
            DisabledFill: =IconHeaderCreateNew.Fill
            FocusedBorderColor: =IconHeaderCreateNew.BorderColor
            Height: =46
            HoverBorderColor: =ColorFade(IconHeaderCreateNew.BorderColor, 20%)
            HoverColor: =ColorFade(IconHeaderCreateNew.Color, 20%)
            HoverFill: =IconHeaderCreateNew.Fill
            Icon: =Icon.Add
            OnSelect: |+
                =Set(_editingRequest, false);
                Navigate(NewRequestScreen, BorderStyle.None);
                Set(_selectedLeaveType,Blank())
                
            PaddingBottom: =7
            PaddingLeft: =7
            PaddingRight: =7
            PaddingTop: =7
            PressedBorderColor: =ColorFade(IconHeaderCreateNew.BorderColor, -20%)
            PressedColor: =ColorFade(IconHeaderCreateNew.Color, -20%)
            PressedFill: =IconHeaderCreateNew.Fill
            TabIndex: =0
            Visible: =If(_managerView,false,true)
            Width: =46
            X: =CircleHeaderCreateNew_9.X
            Y: =17
            ZIndex: =10

        LblHeaderCreateNew_9 As label:
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =LblHeaderCreateNew_9.BorderColor
            FocusedBorderThickness: =02
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =80
            HoverBorderColor: =LblHeaderCreateNew_9.BorderColor
            HoverColor: =LblHeaderCreateNew_9.Color
            HoverFill: =LblHeaderCreateNew_9.Fill
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =LblHeaderCreateNew_9.BorderColor
            PressedColor: =LblHeaderCreateNew_9.Color
            PressedFill: =LblHeaderCreateNew_9.Fill
            Size: =13.5
            Text: ="Create Request"
            Visible: =If(_managerView,false,true)
            Width: =155
            X: =1211
            ZIndex: =11

    Group2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =53

        Rectangle3_4 As rectangle:
            DisabledFill: =Rectangle3_4.Fill
            Fill: =RGBA(249, 249, 249, 1)
            FocusedBorderColor: =Rectangle3_4.BorderColor
            Height: =688
            HoverFill: =Rectangle3_4.Fill
            OnSelect: =
            PressedFill: =Rectangle3_4.Fill
            Width: =315
            X: =1051
            Y: =80
            ZIndex: =13

        RequestDetailsTitle_2 As label:
            Color: =RGBA(62, 96, 170, 1)
            Font: =Font.'Lato Black'
            OnSelect: =
            Size: =14
            Text: ="Request Details"
            Underline: =true
            Width: =161
            X: =1066
            Y: =121
            ZIndex: =14

        EditLable_2 As label:
            BorderThickness: =2
            Color: =RGBA(101, 128, 187, 1)
            FocusedBorderThickness: =3
            Font: =Font.'Lato Black'
            FontWeight: =FontWeight.Semibold
            Height: =30
            HoverBorderColor: =RGBA(62, 96, 170, 1)
            HoverFill: =RGBA(230, 229, 229, 1)
            OnSelect: |-
                =Set(
                    _editingRequest,
                    true
                );
                Navigate(
                    NewRequestScreen,
                    ScreenTransition.None
                );
            Text: ="EDIT"
            Visible: =!_managerView && (GalleryRequest.Selected.Status.Value) = "Pending"
            Width: =54
            X: =1122
            Y: =552
            ZIndex: =15

        EditIcon_2 As icon.Edit:
            Height: =30
            Icon: =Icon.Edit
            OnSelect: =
            Visible: =!_managerView && (GalleryRequest.Selected.Status.Value) = "Pending"
            Width: =23
            X: =1089
            Y: =552
            ZIndex: =16

        ButtonManagerApprove_2 As button:
            BorderColor: =RGBA(54, 176, 75, 1)
            Color: =RGBA(54, 176, 75, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =27
            OnSelect: |
                =Set(LeaveTempID,LookUp(LeaveApp_Request,ID = GalleryRequest.Selected.ID));
                Set(DecisionDateTemp,Now());
                
                Patch(LeaveApp_Request,LeaveTempID,{Status: {
                            Value: "Approved"
                        }}
                        ,{Decision_Date: DecisionDateTemp}
                        ,{Remarks_By_Decision_Maker: RemarksTextBox.Text}
                        ,{
                        Decision_By: {
                            '@odata.type': "Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims: "i:0#.f|membership|" & Lower(User().Email),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: ".",
                            Picture: "."
                        }
                    }
                        );
                
                Set(UnpaidTemp,GalleryRequest.Selected.UnpaidLeave);
                
                Set(LeaveAnnualCarriedTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualCarriedForward);
                Set(LeaveAnnualTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualLeaveTaken);
                Set(LeaveMedicalTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MedicalLeaveTaken);
                Set(LeaveCasualImmediateTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).CompassionateLeaveTaken);
                Set(LeaveCasualSecondTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).CasualSecondLeaveTaken);
                Set(LeaveMarriageTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MarriageLeaveTaken);
                Set(LeavePaternityTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).PaternityLeaveTaken);
                Set(LeaveMaternityTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MaternityLeaveTaken);
                Set(LeaveHospitalizationTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).HospitalizationLeaveTaken);
                
                Set(LeaveAnnualEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).AnnualLeaveEntitlement);
                Set(LeaveMedicalEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MedicalLeaveEntitlement);
                Set(LeaveCasualImmediateEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).CompassionateLeaveEntitlement);
                Set(LeaveCasualSecondEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).CasualSecondLeaveEntitlement);
                Set(LeaveMarriageEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MarriageLeaveEntitlement);
                Set(LeavePaternityEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).PaternityLeaveEntitlement);
                Set(LeaveMaternityEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).MaternityLeaveEntitlement);
                Set(LeaveHospitalizationEntitleTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).HospitalizationLeaveEntitlement);
                
                Set(LeaveUnpaidTakenTemp,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email).UnpaidLeaveTaken);
                Set(LeaveRequestedToEmail,GalleryRequest.Selected.Requested_to.Email);
                Set(LeaveCreatedByEmail,GalleryRequest.Selected.Requested_to.Email);
                
                
                Set(TypeTemp,GalleryRequest.Selected.Leave_Type.Value);
                Set(DaysTemp,GalleryRequest.Selected.Days);
                Set(LeaveTempEmail,LookUp(LeaveApp_Employee,NameofEmployee.Email = GalleryRequest.Selected.Created_By.Email));
                
                If((TypeTemp = "Annual"),
                If((LeaveAnnualCarriedTemp >= DaysTemp),Patch(LeaveApp_Employee,LeaveTempEmail,{AnnualCarriedForward: LeaveAnnualCarriedTemp - DaysTemp}),If((UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{AnnualCarriedForward: 0},{AnnualLeaveTaken: LeaveAnnualTakenTemp + (DaysTemp - LeaveAnnualCarriedTemp)}),Patch(LeaveApp_Employee,LeaveTempEmail,{AnnualCarriedForward: 0},{AnnualLeaveTaken: LeaveAnnualEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                );
                
                If((TypeTemp = "Medical"),
                If((TypeTemp = "Medical" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{MedicalLeaveTaken: LeaveMedicalTakenTemp + DaysTemp}),Patch(LeaveApp_Employee,LeaveTempEmail,{MedicalLeaveTaken: LeaveMedicalEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                If((TypeTemp = "Casual Immediate"),
                If((TypeTemp = "Casual Immediate" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{CompassionateLeaveTaken: LeaveCasualImmediateTakenTemp + DaysTemp}),Patch(LeaveApp_Employee,LeaveTempEmail,{CompassionateLeaveTaken: LeaveCasualImmediateEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                If((TypeTemp = "Casual Second"),
                If((TypeTemp = "Casual Second" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{CasualSecondLeaveTaken: LeaveCasualSecondTakenTemp + DaysTemp}),Patch(LeaveApp_Employee,LeaveTempEmail,{CasualSecondLeaveTaken: LeaveCasualSecondEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                If((TypeTemp = "Hospitalization"),
                If((TypeTemp = "Hospitalization" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{HospitalizationLeaveTaken: LeaveHospitalizationTakenTemp + DaysTemp}),Patch(LeaveApp_Employee,LeaveTempEmail,{HospitalizationLeaveTaken: LeaveHospitalizationEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                If((TypeTemp = "Paternity"),
                If((TypeTemp = "Paternity" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{PaternityLeaveTaken: LeavePaternityTakenTemp + DaysTemp }),Patch(LeaveApp_Employee,LeaveTempEmail,{PaternityLeaveTaken: LeavePaternityEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                If((TypeTemp = "Marriage"),
                If((TypeTemp = "Marriage" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{MarriageLeaveTaken: LeaveMarriageTakenTemp + DaysTemp}),Patch(LeaveApp_Employee,LeaveTempEmail,{MarriageLeaveTaken: LeaveMarriageEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                If((TypeTemp = "Maternity"),
                If((TypeTemp = "Maternity" && UnpaidTemp <= 0),Patch(LeaveApp_Employee,LeaveTempEmail,{MaternityLeaveTaken: LeaveMaternityTakenTemp + DaysTemp}),Patch(LeaveApp_Employee,LeaveTempEmail,{MaternityLeaveTaken: LeaveMaternityEntitleTemp},{UnpaidLeaveTaken: LeaveUnpaidTakenTemp + UnpaidTemp})));
                
                Office365.SendEmailV2(
                            LeaveRequestedToEmail;LeaveCreatedByEmail,
                            "Acknowledgement Leave Request Approved",
                
                            "<div style=""font-family: Calibri; font-size:15px;"">" &
                
                            "Hi " & GalleryRequest.Selected.Created_By.DisplayName &
                            "," &
                
                
                            "Your leave request has been ""<font color = green>approved</font>"".<br><br>" &
                
                            
                            "<br><b><strong>Leave type:</strong></b> " & GalleryRequest.Selected.Leave_Type.Value &
                            "<br><b><strong>Total days:</strong></b> " & GalleryRequest.Selected.Days & 
                            "<br><b><strong>Start date:</strong></b> " & GalleryRequest.Selected.Start_Date &
                            "<br><b><strong>End date:</strong></b> " & GalleryRequest.Selected.End_Date & 
                            "<br><b><strong>Leave detail:</strong></b> " & GalleryRequest.Selected.Comments &
                
                
                            "<br><br><br>If you have any further questions, please check with your supervisor and HR." & 
                            "</div>"
                            ,
                            {Importance: "Normal"}
                        )
            Size: =11
            Text: ="Approve"
            Visible: |
                =_managerView && (GalleryRequest.Selected.Status.Value) = "Pending"
            Width: =78
            X: =1110
            Y: =681
            ZIndex: =17

        ButtonManagerDecline_2 As button:
            BorderColor: =RGBA(213, 25, 32, 1)
            Color: =RGBA(213, 25, 32, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =27
            OnSelect: |-
                =Set(LeaveTempID,LookUp(LeaveApp_Request,ID = GalleryRequest.Selected.ID));
                Set(DecisionDateTemp,Now());
                
                Set(LeaveRequestedToEmail,GalleryRequest.Selected.Requested_to.Email);
                Set(LeaveCreatedByEmail,GalleryRequest.Selected.Requested_to.Email);
                
                Patch(LeaveApp_Request,LeaveTempID,{Status: {
                            '@odata.type': "Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Value: "Rejected"
                        }}
                        ,{Decision_Date: Now()}
                        ,{Remarks_By_Decision_Maker: RemarksTextBox.Text}
                        ,{
                        Decision_By: {
                            '@odata.type': "Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims: "i:0#.f|membership|" & Lower(User().Email),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: ".",
                            Picture: "."
                        }
                    }
                        );
                
                        Office365.SendEmailV2(
                            LeaveRequestedToEmail;LeaveCreatedByEmail,
                            "Acknowledgement Leave Request Rejected",
                
                            "<div style=""font-family: Calibri; font-size:15px;"">" &
                
                            "Hi " & GalleryRequest.Selected.Created_By.DisplayName &
                            "," &
                
                
                            "Your leave request has been ""<font color = red>rejected</font>"".<br><br>" &
                
                            
                            "<br><b><strong>Leave type:</strong></b> " & GalleryRequest.Selected.Leave_Type.Value &
                            "<br><b><strong>Total days:</strong></b> " & GalleryRequest.Selected.Days & 
                            "<br><b><strong>Start date:</strong></b> " & GalleryRequest.Selected.Start_Date &
                            "<br><b><strong>End date:</strong></b> " & GalleryRequest.Selected.End_Date & 
                            "<br><b><strong>Leave detail:</strong></b> " & GalleryRequest.Selected.Comments &
                
                
                            "<br><br><br>If you have any further questions, please check with your supervisor and HR." & 
                            "</div>"
                            ,
                            {Importance: "Normal"}
                        )
            Size: =11
            Text: ="Decline"
            Visible: =_managerView && (GalleryRequest.Selected.Status.Value) = "Pending"
            Width: =78
            X: =1202
            Y: =681
            ZIndex: =18

        Leave_Type_2 As label:
            FontWeight: =FontWeight.Semibold
            Height: =34
            OnSelect: =
            Text: =If(IsBlank(GalleryRequest.Selected.Leave_Type.Value) , "-", GalleryRequest.Selected.Leave_Type.Value)
            Width: =278
            X: =1071
            Y: =203
            ZIndex: =20

        Request_To_2 As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            OnSelect: =
            Size: =12.5
            Text: =If(IsBlank(GalleryRequest.Selected.Requested_to.DisplayName) , "-", GalleryRequest.Selected.Requested_to.DisplayName)
            Width: =295
            X: =1071
            Y: =281
            ZIndex: =21

        CarryForwardDays_2 As label:
            FontWeight: =FontWeight.Semibold
            Height: =25
            OnSelect: =
            Text: =If(IsBlank(GalleryRequest.Selected.CarryForwardDays) , "-", GalleryRequest.Selected.CarryForwardDays& " day(s)")
            Width: =229
            X: =1071
            Y: =358
            ZIndex: =22

        UnpaidLeave_2 As label:
            FontWeight: =FontWeight.Semibold
            Height: =24
            OnSelect: =
            Text: =If(IsBlank(GalleryRequest.Selected.UnpaidLeave) , "-", GalleryRequest.Selected.UnpaidLeave& " day(s)")
            Width: =161
            X: =1071
            Y: =423
            ZIndex: =23

        LblLeaveType_2 As label:
            Height: =28
            OnSelect: =
            Text: |-
                ="Leave Type:"
            Width: =156
            X: =1071
            Y: =173
            ZIndex: =25

        LblRequestTo_2 As label:
            Height: =38
            OnSelect: =
            Text: |-
                ="Request Sent To:"
            Width: =167
            X: =1071
            Y: =247
            ZIndex: =26

        LblCarryForward_2 As label:
            Height: =19
            OnSelect: =
            Text: |-
                ="Carry Forward Days:"
            Width: =206
            X: =1071
            Y: =331
            ZIndex: =27

        LblUnpaidLeave_2 As label:
            Height: =30
            OnSelect: =
            Text: |-
                ="Unpaid Leaves:"
            Width: =171
            X: =1071
            Y: =392
            ZIndex: =28

        RemarksTextBox As text:
            Default: =""
            Height: =68
            Visible: =_managerView && (GalleryRequest.Selected.Status.Value) = "Pending"
            Width: =239
            X: =1080
            Y: =590
            ZIndex: =31

        remarksHeader As label:
            Height: =23
            Text: |-
                ="Remarks From Approver: "
            Visible: =_managerView
            Width: =248
            X: =1071
            Y: =548
            ZIndex: =32

        LabelRemarks_1 As label:
            Color: =RGBA(0, 0, 0, 1)
            FontWeight: =FontWeight.Semibold
            Height: =109
            Overflow: =Overflow.Scroll
            Text: =If(IsBlank(GalleryRequest.Selected.Remarks_By_Decision_Maker) , "-", GalleryRequest.Selected.Remarks_By_Decision_Maker)
            Visible: |
                =_managerView && ((GalleryRequest.Selected.Status.Value) = "Approved" || (GalleryRequest.Selected.Status.Value) = "Rejected")
            Width: =248
            X: =1071
            Y: =572
            ZIndex: =33

