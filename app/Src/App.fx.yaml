App As appinfo:
    BackEnabled: =true
    OnError: =
    OnStart: |
        =Set(
            _sendEmailsEnabled,
            false
        );
        
            //collection used in the left nav menu
        ClearCollect(
            EmployeeNavigation,
            {
                Title: "My Leave Requests",
                TargetScreen: HomeScreen
            },
            {
                Title: "My Leave Balance",
                TargetScreen: LeaveBalanceScreen
            },
            {
                Title: "Today's On Leave",
                TargetScreen: TodayOnLeaveScreen
            },
            {
                Title: "Public Holidays",
                TargetScreen: CompanyHolidaysScreen
            },
            {
                Title: "About",
                TargetScreen: AboutScreen
            },
            {
                Title: "Log Out",
                TargetScreen: LoginScreen
            }
        );
            //collection used in the left nav menu
        ClearCollect(
            ManagerNavigation,
            {
                Title: "Leave Requests",
                TargetScreen: HomeScreen
            },
            {
                Title: "Today's On Leave",
                TargetScreen: TodayOnLeaveScreen
            },
            {
                Title: "Employee Leave Balance",
                TargetScreen: EmployeeLeaveBalance
            },
            {
                Title: "Public Holidays",
                TargetScreen: CompanyHolidaysScreen
            },
            {
                Title: "Log Out",
                TargetScreen: LoginScreen
            }
        );
            //add custom leave types to this collection to make them show up in the app
        ClearCollect(
            LeaveTypeCollection,
            Table(
                {
                    type: "Annual",
                    icon: vacation,
                    iconselected: 'vacation-selected',
                    description:  "<b>Details:</b>
        <div style='font-weight:600;'>            
        <p>
        1.  Annual Leave Entitlement: 
            <br>- For employees with less than 3 years of service: 14 days
            <br>- For employees with more than 3 years of service: 16 days
            <br>- For employees in positions at Team Lead level and above, with more than 5years of service: 18 days
        </p>
        <p>
        2.  Annual Leave Carry Forward Policy:
            <br>- A maximum of seven (07) days of annual leave can be carried forward to the next calendar year.
            <br>- Any excess leave not utilized by the end of March (the next quarter) of the following calendar year       will be deemed forfeited.</p></div>   
            "
                },
                {
                    type: "Medical",
                    icon: 'sick-leave',
                    iconselected: 'sick-leave-selected',
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>            
        <p>
        1. Medical Leave shall be defined as approved leave of absence resulting from illness, disease or injury as certified by the Company Panel Doctor / Government Medical Officer / registered medical practitioner. An employee shall also be entitled to paid leave after examination by a dental surgeon as defined in the Dental Act 1971.
        </p>
        <p>
        2. Entitlement:						
            <br>- Without hospitalization: 14 days						
            <br>- With hospitalization: 60 days, including non-hospitalization days. (Please select Hospitalization Leave for this)
        </p>
        <p>
        3. Supporting Document: Medical Certificate (MC)</p></div>"
                },
                {
                    type: "Hospitalization",
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>            
        <p>            
        1. Medical Leave shall be defined as approved leave of absence resulting from illness, disease or injury as certified by the Company Panel Doctor / Government Medical Officer / registered medical practitioner. An employee shall also be entitled to paid leave after examination by a dental surgeon as defined in the Dental Act 1971.							
        </p>
        <p>							
        2. Entitlement: 60 days, including non-hospitalization days (From Medical Leave).							
        </p>
        <p>							
        3. Supporting Document: Please refer HR for more information</p></div>"
                },
                {
                    type: "Casual Immediate",
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>
        <p>            
        1. Death of a member of the employee's family. First relation (parents/ parents-in-law/ spouse/ children)
        </p>
        <p>
        2. Entitlement: 3 days	
        </p>
        <p>
        3. The total number of days for both Casual Immediate and Casual Second shall be capped at 3 days in any calendar year.</p></div>"
                },
                {
                    type: "Casual Second",
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>
        <p>            
        1. Death of a member of the employee's family. Second relations (grandparents / brothers / sisters /         grandchildren)
        </p>
        <p>
        2. Entitlement: 2 days	
        </p>
        <p>
        3. The total number of days for both Casual Immediate and Casual Second shall be capped at 3 days in any calendar year.</p></div>"
                },
                {
                    type: "Paternity",
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>
        <p>            
        1. Requirements for Subsection 60FA:					
            <br>- The male employee must be married to the mother in question.					
            <br>- He must have been employed by the same employer for at least 12 months.					
            <br>- He must notify the employer at least 30 days from expected confinement (or as early as possible).	
        </p>
        <p>
        2. Entitlement: 7 consecutive days 	 </p></div>"
                },
                {
                    type: "Maternity",
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>            
        <p>            
        1. A full-time confirmed female employee. For miscarriage maternity leave only apply upon seven full months of pregnancy under the labour law.								
        </p>
        <p>								
        2. Entitlement: 98 consecutive days	</p></div>"
                },
                {
                    type: "Marriage",
                    description: "<b>Details:</b>
        <div style='font-weight: 600px'>
        <p>    
        1. A full-time confirmed employee who has completed a minimum of twelve (12) months of continuous service of his first legal marriage while in the service of the Company.										
        </p>
        <p>										
        2. Entitlement: 3 days</p></div>"
                }
            )
        );
            //defines leave start and end for requests. Default set to Now since most users will be creating new requests. Changes to reflect leave times for requests which are being edited
        ClearCollect(
            EmailTemplate,
            "<html>
                <head>
                    <meta http-equiv=""Content-Type"" content=""text/html; charset=us-ascii"">
                </head>
                <body>
                <p>
                There is a leave request from:  {SubmitterName}  pending your approval. <ul><li>Type:  {LeaveType}</li><li>Title: {LeaveTitle}</li><li>Description: {LeaveDescript}</li><li>Start Date: {LeaveStart}</li><li>End Date: {LeaveEnd}</li>" & "</p>
                </body>
                </html>"
        );
        ClearCollect(
            HolidayCollection,
            LeaveApp_PublicHoliday
        );
        Set(
            _leaveStart,
            Now()
        );
        Set(
            _leaveEnd,
            Now()
        );
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

